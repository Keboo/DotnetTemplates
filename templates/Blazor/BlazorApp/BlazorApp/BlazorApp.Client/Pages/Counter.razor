@page "/counter"
@rendermode InteractiveAuto
@inject DialogService DialogService
@inject NotificationService NotificationService

<PageTitle>Counter</PageTitle>

<RadzenCard>
    <RadzenStack Gap="1rem">
        <RadzenText TextStyle="TextStyle.H3">Counter</RadzenText>
        
        <RadzenText TextStyle="TextStyle.Body1">
            Current count: <RadzenBadge BadgeStyle="BadgeStyle.Info" Text="@currentCount.ToString()" />
        </RadzenText>
        
        <RadzenStack Orientation="Orientation.Horizontal" Gap="0.5rem" Wrap="FlexWrap.Wrap">
            <RadzenButton Text="Increment" Icon="add" ButtonStyle="ButtonStyle.Primary" Click="@IncrementCount" />
            <RadzenButton Text="Decrement" Icon="remove" ButtonStyle="ButtonStyle.Secondary" Click="@DecrementCount" />
            <RadzenButton Text="Reset" Icon="refresh" ButtonStyle="ButtonStyle.Light" Click="@ResetCount" />
            <RadzenButton Text="Show Dialog" Icon="info" ButtonStyle="ButtonStyle.Info" Click="@ShowDialog" />
        </RadzenStack>
        
        <RadzenProgressBar Value="@progress" ShowValue="true" Mode="ProgressBarMode.Determinate" />
        
        <RadzenSlider @bind-Value="@currentCount" Min="0" Max="100" />
    </RadzenStack>
</RadzenCard>

@code {
    private int currentCount = 0;
    private double progress => Math.Min((currentCount / 100.0) * 100, 100);

    private void IncrementCount()
    {
        currentCount++;
        NotificationService.Notify(new NotificationMessage 
        { 
            Severity = NotificationSeverity.Success, 
            Summary = "Counter Incremented", 
            Detail = $"Count is now {currentCount}", 
            Duration = 2000 
        });
    }
    
    private void DecrementCount()
    {
        if (currentCount > 0)
        {
            currentCount--;
            NotificationService.Notify(new NotificationMessage 
            { 
                Severity = NotificationSeverity.Info, 
                Summary = "Counter Decremented", 
                Detail = $"Count is now {currentCount}", 
                Duration = 2000 
            });
        }
    }
    
    private void ResetCount()
    {
        currentCount = 0;
        NotificationService.Notify(new NotificationMessage 
        { 
            Severity = NotificationSeverity.Warning, 
            Summary = "Counter Reset", 
            Detail = "Count is now 0", 
            Duration = 2000 
        });
    }
    
    private async Task ShowDialog()
    {
        await DialogService.OpenAsync("Counter Information", ds =>
            @<div>
                <p>The current count is: <strong>@currentCount</strong></p>
                <RadzenButton Text="Close" Click="() => ds.Close()" />
            </div>
        );
    }
}
